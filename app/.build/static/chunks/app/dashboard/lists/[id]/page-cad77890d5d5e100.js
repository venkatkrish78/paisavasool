(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[465],{2888:function(e,t,s){Promise.resolve().then(s.bind(s,3050)),Promise.resolve().then(s.t.bind(s,1965,23))},3050:function(e,t,s){"use strict";s.d(t,{ShoppingListItems:function(){return N}});var r=s(784),i=s(1960),a=s(3866),l=s(1555),n=s(5762);let c=(0,s(6382).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var d=s(4705),o=s(5861),h=s(4131),m=s(398),u=s(9218),f=s(395),p=s(5796),x=s(9026),j=s(1789),y=s(4428);function N(e){let{listId:t}=e,[s,N]=(0,i.useState)([]),[b,w]=(0,i.useState)(!0),[g,v]=(0,i.useState)(!1),k=(0,a.useRouter)(),{toast:C}=(0,f.pm)(),{ref:R,inView:E}=(0,u.YD)({triggerOnce:!1,threshold:.1}),S=async()=>{try{let e=await fetch("/api/shopping-lists/".concat(t,"/items"));if(!e.ok)throw Error("Failed to fetch items");let s=await e.json();N(s)}catch(e){C({title:"Error",description:"Failed to load items. Please refresh the page.",variant:"destructive"})}finally{w(!1)}};(0,i.useEffect)(()=>{S()},[t,C]);let Z=async e=>{if(confirm("Are you sure you want to delete this item?"))try{if(!(await fetch("/api/shopping-lists/".concat(t,"/items/").concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete item");N(s.filter(t=>t.id!==e)),C({title:"Success",description:"Item deleted successfully"})}catch(e){C({title:"Error",description:"Failed to delete item",variant:"destructive"})}},T=async()=>{v(!0);try{if(!(await fetch("/api/shopping-lists/".concat(t,"/refresh-prices"),{method:"POST"})).ok)throw Error("Failed to refresh prices");await S(),C({title:"Success",description:"Prices refreshed successfully"})}catch(e){C({title:"Error",description:"Failed to refresh prices",variant:"destructive"})}finally{v(!1)}},F=e=>{if(!e||0===e.length)return null;let t=e.filter(e=>e.available);return 0===t.length?null:t.reduce((e,t)=>t.price<e.price?t:e,t[0])};return b?(0,r.jsx)("div",{className:"flex justify-center items-center h-40",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("h2",{className:"text-2xl font-bold flex items-center",children:[(0,r.jsx)(n.Z,{className:"mr-2 h-6 w-6 text-primary"}),"Shopping List Items"]}),(0,r.jsxs)(p.z,{onClick:T,disabled:g,variant:"outline",children:[(0,r.jsx)(c,{className:"mr-2 h-4 w-4 ".concat(g?"animate-spin":"")}),g?"Refreshing...":"Refresh Prices"]})]}),0===s.length?(0,r.jsx)(x.Zb,{className:"bg-muted/50",children:(0,r.jsxs)(x.aY,{className:"pt-6 text-center",children:[(0,r.jsx)("p",{className:"mb-4",children:"No items in this shopping list yet."}),(0,r.jsxs)(p.z,{onClick:()=>k.push("/dashboard/lists/".concat(t,"/add-item")),children:[(0,r.jsx)(d.Z,{className:"mr-2 h-4 w-4"}),"Add Your First Item"]})]})}):(0,r.jsx)(l.E.div,{ref:R,variants:{hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},initial:"hidden",animate:E?"show":"hidden",children:(0,r.jsxs)(x.Zb,{children:[(0,r.jsx)(x.Ol,{children:(0,r.jsxs)(x.ll,{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(o.Z,{className:"h-5 w-5 mr-2 text-primary"}),(0,r.jsxs)("span",{children:["Items (",s.length,")"]})]}),(0,r.jsxs)(p.z,{size:"sm",onClick:()=>k.push("/dashboard/lists/".concat(t,"/compare")),children:[(0,r.jsx)(h.Z,{className:"mr-2 h-4 w-4"}),"Compare & Optimize"]})]})}),(0,r.jsx)(x.aY,{children:(0,r.jsxs)(y.iA,{children:[(0,r.jsx)(y.xD,{children:(0,r.jsxs)(y.SC,{children:[(0,r.jsx)(y.ss,{children:"Item"}),(0,r.jsx)(y.ss,{children:"Quantity"}),(0,r.jsx)(y.ss,{children:"Best Price"}),(0,r.jsx)(y.ss,{children:"Platform"}),(0,r.jsx)(y.ss,{className:"text-right",children:"Actions"})]})}),(0,r.jsx)(y.RM,{children:s.map(e=>{let t=F(e.prices);return(0,r.jsxs)(y.SC,{children:[(0,r.jsx)(y.pj,{className:"font-medium",children:e.name}),(0,r.jsxs)(y.pj,{children:[e.quantity," ",e.unit&&(0,r.jsx)("span",{className:"text-muted-foreground",children:e.unit})]}),(0,r.jsx)(y.pj,{children:t?(0,r.jsxs)("span",{className:"font-medium",children:["â‚¹",t.price.toFixed(2)]}):(0,r.jsx)(j.C,{variant:"outline",children:"No price data"})}),(0,r.jsx)(y.pj,{children:t?(0,r.jsx)(j.C,{children:t.platform}):(0,r.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,r.jsx)(y.pj,{className:"text-right",children:(0,r.jsxs)(p.z,{variant:"ghost",size:"sm",onClick:()=>Z(e.id),children:[(0,r.jsx)(m.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Delete"})]})})]},e.id)})})]})})]})})]})}},4428:function(e,t,s){"use strict";s.d(t,{RM:function(){return c},SC:function(){return d},iA:function(){return l},pj:function(){return h},ss:function(){return o},xD:function(){return n}});var r=s(784),i=s(1960),a=s(5518);let l=i.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:t,className:(0,a.cn)("w-full caption-bottom text-sm",s),...i})})});l.displayName="Table";let n=i.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,r.jsx)("thead",{ref:t,className:(0,a.cn)("[&_tr]:border-b",s),...i})});n.displayName="TableHeader";let c=i.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,r.jsx)("tbody",{ref:t,className:(0,a.cn)("[&_tr:last-child]:border-0",s),...i})});c.displayName="TableBody",i.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,r.jsx)("tfoot",{ref:t,className:(0,a.cn)("bg-primary font-medium text-primary-foreground",s),...i})}).displayName="TableFooter";let d=i.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,r.jsx)("tr",{ref:t,className:(0,a.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...i})});d.displayName="TableRow";let o=i.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,r.jsx)("th",{ref:t,className:(0,a.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...i})});o.displayName="TableHead";let h=i.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,r.jsx)("td",{ref:t,className:(0,a.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...i})});h.displayName="TableCell",i.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,r.jsx)("caption",{ref:t,className:(0,a.cn)("mt-4 text-sm text-muted-foreground",s),...i})}).displayName="TableCaption"},5762:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(6382).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])}},function(e){e.O(0,[813,965,387,427,275,744],function(){return e(e.s=2888)}),_N_E=e.O()}]);