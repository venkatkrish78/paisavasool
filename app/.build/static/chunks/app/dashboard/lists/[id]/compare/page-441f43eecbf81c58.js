(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[188],{5865:function(e,r,t){Promise.resolve().then(t.bind(t,634)),Promise.resolve().then(t.t.bind(t,1965,23))},634:function(e,r,t){"use strict";t.d(r,{PriceComparison:function(){return I}});var s=t(784),a=t(1960),i=t(1672),n=t(6564),l=t(6070),o=t(9218),c=t(3968),d=t(3644),m=t(500),f=t(7518),u=t(5861),p=t(9461),x=t(6585),h=t(8005),g=t(9523),j=t(4131),y=t(395),b=t(5796),N=t(9026),v=t(1789),w=t(4428),A=t(9717),S=t(5518);let C=A.fC,O=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)(A.aV,{ref:r,className:(0,S.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...a})});O.displayName=A.aV.displayName;let E=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)(A.xz,{ref:r,className:(0,S.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...a})});E.displayName=A.xz.displayName;let T=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)(A.VY,{ref:r,className:(0,S.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...a})});function k(e){let{children:r,content:t,side:i="top",align:n="center"}=e,[l,o]=a.useState(!1),[c,d]=a.useState({x:0,y:0}),m=a.useRef(null);return(0,s.jsxs)("div",{className:"relative inline-block",children:[(0,s.jsx)("div",{ref:m,onMouseEnter:()=>{if(m.current){let e=m.current.getBoundingClientRect(),r=e.left+e.width/2,t=e.top;"bottom"===i?t=e.bottom:"left"===i?(r=e.left,t=e.top+e.height/2):"right"===i&&(r=e.right,t=e.top+e.height/2),"start"===n?"top"===i||"bottom"===i?r=e.left:t=e.top:"end"===n&&("top"===i||"bottom"===i?r=e.right:t=e.bottom),d({x:r,y:t})}o(!0)},onMouseLeave:()=>{o(!1)},className:"inline-flex cursor-help",children:r}),l&&(0,s.jsx)("div",{className:"fixed z-50 px-3 py-1.5 text-xs font-medium text-white bg-gray-900 rounded-md shadow-sm dark:bg-gray-700 animate-in fade-in-0 zoom-in-95",style:{transform:"translate(".concat("left"===i?"-100%":"right"===i?"0":"-50%",", ").concat("top"===i?"-100%":"bottom"===i?"0":"-50%",")"),left:"".concat(c.x,"px"),top:"".concat(c.y,"px")},children:t})]})}function I(e){var r;let{listId:t}=e,[A,I]=(0,a.useState)([]),[P,Z]=(0,a.useState)([]),[R,z]=(0,a.useState)(!0),[V,_]=(0,a.useState)(!1),[F,q]=(0,a.useState)(null),{toast:D}=(0,y.pm)(),{ref:G,inView:M}=(0,o.YD)({triggerOnce:!1,threshold:.1}),Y=async()=>{try{q(null),console.log("Fetching items for list:",t);let e=await fetch("/api/shopping-lists/".concat(t,"/items"));if(!e.ok)throw Error("Failed to fetch items: ".concat(e.status," ").concat(e.statusText));let r=await e.json();console.log("Items data received:",r),I(Array.isArray(r)?r:[]),console.log("Fetching platform info");let s=await fetch("/api/platforms");if(!s.ok)throw Error("Failed to fetch platform information: ".concat(s.status," ").concat(s.statusText));let a=await s.json();console.log("Platform data received:",a),Z(Array.isArray(a)?a:[])}catch(e){console.error("Error fetching data:",e),q(e instanceof Error?e.message:"An unknown error occurred"),D({title:"Error",description:"Failed to load data. Please refresh the page.",variant:"destructive"})}finally{z(!1)}};(0,a.useEffect)(()=>{Y()},[t,D]);let U=async()=>{_(!0),q(null);try{console.log("Refreshing prices for list:",t);let e=await fetch("/api/shopping-lists/".concat(t,"/refresh-prices"),{method:"POST"});if(!e.ok)throw Error("Failed to refresh prices: ".concat(e.status," ").concat(e.statusText));await Y(),D({title:"Success",description:"Prices refreshed with real-time data from all platforms"})}catch(e){console.error("Error refreshing prices:",e),q(e instanceof Error?e.message:"An unknown error occurred"),D({title:"Error",description:"Failed to refresh prices. Please try again.",variant:"destructive"})}finally{_(!1)}},L={hidden:{opacity:0,y:20},show:{opacity:1,y:0}},{platformTotals:B,platformItems:H}=(()=>{let e={},r={};return Array.isArray(P)&&P.forEach(t=>{t&&t.name&&(e[t.name]=0,r[t.name]=[])}),Array.isArray(A)&&A.forEach(t=>{t&&t.prices&&Array.isArray(t.prices)&&t.prices.forEach(s=>{if(s&&s.platform&&s.available&&"number"==typeof s.price){let a=s.price*("number"==typeof t.quantity?t.quantity:1);"number"!=typeof e[s.platform]&&(e[s.platform]=0),e[s.platform]+=a,Array.isArray(r[s.platform])||(r[s.platform]=[]),r[s.platform].find(e=>e&&e.id===t.id)||r[s.platform].push({...t,prices:[s]})}})}),Array.isArray(P)&&P.forEach(r=>{if(r&&r.name&&"number"==typeof e[r.name]){let t=e[r.name];t>0&&t>=(r.minOrderValue||0)&&(e[r.name]+=r.deliveryFee||0)}}),{platformTotals:e,platformItems:r}})(),Q=(null===(r=Object.entries(B).filter(e=>{let[r,t]=e;return"number"==typeof t&&t>0}).sort((e,r)=>{let[t,s]=e,[a,i]=r;return s-i})[0])||void 0===r?void 0:r[0])||null,W=Array.isArray(A)?A.filter(e=>e&&e.prices&&Array.isArray(e.prices)&&e.prices.length>0):[],X=(0,S.np)(W),J=X.totalCost;X.platformItems&&"object"==typeof X.platformItems&&Object.keys(X.platformItems).forEach(e=>{let r=Array.isArray(P)?P.find(r=>r&&r.name===e):void 0;if(r){let t=X.platformItems[e];Array.isArray(t)&&t.reduce((e,r)=>{if(!r)return e;let t=r.bestPrice;return e+(t&&"number"==typeof t.price?t.price:0)*("number"==typeof r.quantity?r.quantity:1)},0)>=(r.minOrderValue||0)&&(J+=r.deliveryFee||0)}});let K=Q&&"number"==typeof B[Q]?B[Q]:0,$=K>0?K-J:0,ee=K>0?Math.round($/K*100):0,er=(()=>{let e=null;if(Array.isArray(A)&&A.forEach(r=>{r&&r.prices&&Array.isArray(r.prices)&&r.prices.forEach(r=>{if(r&&r.lastUpdated)try{let t=new Date(r.lastUpdated);(!e||t>e)&&(e=t)}catch(e){console.error("Error parsing date:",e)}})}),!e)return"Never";try{return(0,c.Q)(e,{addSuffix:!0})}catch(e){return console.error("Error formatting date:",e),"Unknown"}})(),et=e=>{if(!e||!e.prices||!Array.isArray(e.prices))return 0;let r=new Set;return e.prices.forEach(e=>{e&&e.platform&&e.available&&r.add(e.platform)}),r.size},es=Array.isArray(A)&&0!==A.length?Math.round(A.reduce((e,r)=>e+et(r),0)/A.length*10)/10:0;return R?(0,s.jsx)("div",{className:"flex justify-center items-center h-40",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):F?(0,s.jsx)(N.Zb,{className:"bg-red-50 dark:bg-red-900/20 border-red-200",children:(0,s.jsxs)(N.aY,{className:"pt-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,s.jsx)(d.Z,{className:"h-6 w-6 text-red-600"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-red-700",children:"Error Loading Comparison"})]}),(0,s.jsx)("p",{className:"mb-4 text-red-600",children:F}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsxs)(b.z,{variant:"outline",onClick:Y,children:[(0,s.jsx)(m.Z,{className:"mr-2 h-4 w-4"}),"Try Again"]}),(0,s.jsx)(b.z,{asChild:!0,children:(0,s.jsxs)(n.default,{href:"/dashboard/lists/".concat(t),children:[(0,s.jsx)(f.Z,{className:"mr-2 h-4 w-4"}),"Return to List"]})})]})]})}):Array.isArray(A)&&0!==A.length?(0,s.jsxs)(l.E.div,{ref:G,variants:{hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},initial:"hidden",animate:M?"show":"hidden",className:"space-y-8",children:[(0,s.jsx)(l.E.div,{variants:L,children:(0,s.jsxs)(N.Zb,{className:"bg-gradient-to-br from-primary/10 to-primary/5",children:[(0,s.jsx)(N.Ol,{children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)(N.ll,{className:"flex items-center text-2xl",children:[(0,s.jsx)(p.Z,{className:"mr-2 h-6 w-6 text-primary"}),"Price Comparison Summary"]}),(0,s.jsxs)(N.SZ,{children:["Compare prices across ",P.length," platforms and find the best deals"]})]}),(0,s.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground",children:[(0,s.jsx)(x.Z,{className:"h-4 w-4 mr-1"}),"Prices updated: ",er,(0,s.jsx)(b.z,{onClick:U,disabled:V,variant:"ghost",size:"sm",className:"ml-2",children:(0,s.jsx)(m.Z,{className:"h-4 w-4 ".concat(V?"animate-spin":"")})})]})]})}),(0,s.jsx)(N.aY,{children:(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[(0,s.jsxs)(N.Zb,{className:"bg-white/50 dark:bg-gray-800/50",children:[(0,s.jsx)(N.Ol,{className:"pb-2",children:(0,s.jsx)(N.ll,{className:"text-lg",children:"Total Items"})}),(0,s.jsx)(N.aY,{children:(0,s.jsx)("div",{className:"text-3xl font-bold",children:A.length})})]}),(0,s.jsxs)(N.Zb,{className:"bg-white/50 dark:bg-gray-800/50",children:[(0,s.jsx)(N.Ol,{className:"pb-2",children:(0,s.jsxs)(N.ll,{className:"text-lg flex items-center",children:["Platforms Per Item",(0,s.jsx)(k,{content:"Average number of platforms with prices for each item",children:(0,s.jsx)(h.Z,{className:"h-4 w-4 ml-1 text-muted-foreground"})})]})}),(0,s.jsxs)(N.aY,{children:[(0,s.jsx)("div",{className:"text-3xl font-bold",children:es}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:["out of ",P.length," platforms"]})]})]}),(0,s.jsxs)(N.Zb,{className:"bg-white/50 dark:bg-gray-800/50",children:[(0,s.jsx)(N.Ol,{className:"pb-2",children:(0,s.jsx)(N.ll,{className:"text-lg",children:"Best Single Platform"})}),(0,s.jsx)(N.aY,{children:Q?(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xl font-bold",children:Q}),(0,s.jsx)("div",{className:"text-lg",children:(0,S.xG)(B[Q])})]}):(0,s.jsx)("div",{className:"text-muted-foreground",children:"No data available"})})]}),(0,s.jsxs)(N.Zb,{className:"bg-green-50 dark:bg-green-900/20",children:[(0,s.jsx)(N.Ol,{className:"pb-2",children:(0,s.jsxs)(N.ll,{className:"text-lg flex items-center",children:[(0,s.jsx)(g.Z,{className:"mr-2 h-4 w-4 text-green-600"}),"Optimized Shopping"]})}),(0,s.jsxs)(N.aY,{children:[(0,s.jsx)("div",{className:"text-xl font-bold text-green-600",children:(0,S.xG)(J)}),$>0&&(0,s.jsxs)("div",{className:"flex items-center mt-1",children:[(0,s.jsxs)(v.C,{variant:"success",className:"mr-2",children:["Save ",ee,"%"]}),(0,s.jsx)("span",{className:"text-sm text-green-600",children:(0,S.xG)($)})]})]})]})]})})]})}),(0,s.jsx)(l.E.div,{variants:L,children:(0,s.jsxs)(C,{defaultValue:"optimized",children:[(0,s.jsxs)(O,{className:"grid w-full grid-cols-2",children:[(0,s.jsx)(E,{value:"optimized",children:"Optimized Shopping"}),(0,s.jsx)(E,{value:"comparison",children:"Platform Comparison"})]}),(0,s.jsx)(T,{value:"optimized",className:"mt-4",children:(0,s.jsxs)(N.Zb,{children:[(0,s.jsxs)(N.Ol,{children:[(0,s.jsxs)(N.ll,{className:"flex items-center",children:[(0,s.jsx)(g.Z,{className:"mr-2 h-5 w-5 text-primary"}),"Optimized Shopping Plan"]}),(0,s.jsx)(N.SZ,{children:"Split your shopping across these platforms to save money"})]}),(0,s.jsx)(N.aY,{children:X.platformItems&&"object"==typeof X.platformItems&&Object.keys(X.platformItems).length>0?(0,s.jsxs)("div",{className:"space-y-6",children:[Object.entries(X.platformItems).map(e=>{var r,t;let[a,l]=e;if(!Array.isArray(l)||0===l.length)return null;let o=Array.isArray(P)?P.find(e=>e&&e.name===a):void 0,c=l.reduce((e,r)=>{if(!r)return e;let t=r.bestPrice;return e+(t&&"number"==typeof t.price?t.price:0)*("number"==typeof r.quantity?r.quantity:1)},0);return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(null==o?void 0:o.logoUrl)?(0,s.jsx)("div",{className:"w-8 h-8 mr-2 relative overflow-hidden rounded",children:(0,s.jsx)(i.default,{src:o.logoUrl,alt:a,fill:!0,className:"object-contain"})}):(0,s.jsx)(v.C,{className:"mr-2",children:a}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:[l.length," ",1===l.length?"item":"items"]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("div",{className:"font-medium",children:(0,S.xG)(c)}),o&&(0,s.jsxs)("div",{className:"text-xs text-muted-foreground",children:["+ ",(0,S.xG)(o.deliveryFee||0)," delivery",(o.minOrderValue||0)>0&&(0,s.jsx)("span",{children:c<(o.minOrderValue||0)?" (min order: ".concat((0,S.xG)(o.minOrderValue||0),")"):""})]})]})]}),(0,s.jsxs)(w.iA,{children:[(0,s.jsx)(w.xD,{children:(0,s.jsxs)(w.SC,{children:[(0,s.jsx)(w.ss,{children:"Item"}),(0,s.jsx)(w.ss,{children:"Quantity"}),(0,s.jsx)(w.ss,{children:"Price"}),(0,s.jsx)(w.ss,{className:"text-right",children:"Total"})]})}),(0,s.jsxs)(w.RM,{children:[l.map(e=>e?(0,s.jsxs)(w.SC,{children:[(0,s.jsx)(w.pj,{className:"font-medium",children:e.name||"Unknown Item"}),(0,s.jsxs)(w.pj,{children:["number"==typeof e.quantity?e.quantity:1,e.unit&&(0,s.jsx)("span",{className:"text-muted-foreground",children:e.unit})]}),(0,s.jsx)(w.pj,{children:e.bestPrice&&"number"==typeof e.bestPrice.price?(0,S.xG)(e.bestPrice.price):"N/A"}),(0,s.jsx)(w.pj,{className:"text-right",children:e.bestPrice&&"number"==typeof e.bestPrice.price?(0,S.xG)(e.bestPrice.price*("number"==typeof e.quantity?e.quantity:1)):"N/A"})]},e.id):null),(0,s.jsxs)(w.SC,{children:[(0,s.jsx)(w.pj,{colSpan:3,className:"text-right font-medium",children:"Subtotal"}),(0,s.jsx)(w.pj,{className:"text-right font-medium",children:(0,S.xG)(c)})]}),o&&(0,s.jsxs)(w.SC,{children:[(0,s.jsx)(w.pj,{colSpan:3,className:"text-right font-medium",children:"Delivery Fee"}),(0,s.jsx)(w.pj,{className:"text-right font-medium",children:(0,S.xG)(o.deliveryFee||0)})]})]})]}),(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsx)(b.z,{asChild:!0,children:(0,s.jsxs)(n.default,{href:(null===(t=l[0])||void 0===t?void 0:null===(r=t.bestPrice)||void 0===r?void 0:r.url)||"https://www.".concat(a.toLowerCase(),".com"),target:"_blank",rel:"noopener noreferrer",children:[(0,s.jsx)(u.Z,{className:"mr-2 h-4 w-4"}),"Shop on ",a,(0,s.jsx)(j.Z,{className:"ml-2 h-4 w-4"})]})})})]},a)}),(0,s.jsx)(N.Zb,{className:"bg-green-50 dark:bg-green-900/20 border-green-200",children:(0,s.jsx)(N.aY,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-green-700",children:"Total Savings"}),(0,s.jsx)("p",{className:"text-sm text-green-600",children:"Compared to best single platform"})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-green-600",children:(0,S.xG)($)}),(0,s.jsxs)(v.C,{variant:"success",children:[ee,"% cheaper"]})]})]})})})]}):(0,s.jsx)("div",{className:"text-center py-6 text-muted-foreground",children:"No price data available for optimization"})})]})}),(0,s.jsx)(T,{value:"comparison",className:"mt-4",children:(0,s.jsxs)(N.Zb,{children:[(0,s.jsxs)(N.Ol,{children:[(0,s.jsxs)(N.ll,{className:"flex items-center",children:[(0,s.jsx)(u.Z,{className:"mr-2 h-5 w-5 text-primary"}),"Platform Price Comparison"]}),(0,s.jsx)(N.SZ,{children:"Compare prices for each item across all platforms"})]}),(0,s.jsx)(N.aY,{children:(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)(w.iA,{children:[(0,s.jsx)(w.xD,{children:(0,s.jsxs)(w.SC,{children:[(0,s.jsx)(w.ss,{children:"Item"}),(0,s.jsx)(w.ss,{children:"Quantity"}),Array.isArray(P)&&P.map(e=>e?(0,s.jsx)(w.ss,{className:"min-w-[120px]",children:(0,s.jsxs)("div",{className:"flex items-center",children:[e.logoUrl?(0,s.jsx)("div",{className:"w-6 h-6 mr-1 relative overflow-hidden rounded",children:(0,s.jsx)(i.default,{src:e.logoUrl,alt:e.name,fill:!0,className:"object-contain"})}):null,e.name]})},e.id):null)]})}),(0,s.jsxs)(w.RM,{children:[Array.isArray(A)&&A.map(e=>{if(!e)return null;let r=et(e);return(0,s.jsxs)(w.SC,{children:[(0,s.jsx)(w.pj,{className:"font-medium",children:(0,s.jsxs)("div",{className:"flex items-center",children:[e.name||"Unknown Item",4===r?(0,s.jsx)(v.C,{variant:"success",className:"ml-2 text-xs",children:"All platforms"}):r>=3?(0,s.jsxs)(v.C,{variant:"secondary",className:"ml-2 text-xs",children:[r," platforms"]}):null]})}),(0,s.jsxs)(w.pj,{children:["number"==typeof e.quantity?e.quantity:1,e.unit&&(0,s.jsx)("span",{className:"text-muted-foreground",children:e.unit})]}),Array.isArray(P)&&P.map(r=>{if(!r)return null;let t=e.prices&&Array.isArray(e.prices)?e.prices.find(e=>e&&e.platform===r.name):void 0;return(0,s.jsx)(w.pj,{children:t?(0,s.jsx)("div",{children:t.available?(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"font-medium",children:(0,S.xG)(t.price)}),t.url&&(0,s.jsxs)(n.default,{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:underline flex items-center mt-1",children:["View ",(0,s.jsx)(j.Z,{className:"ml-1 h-3 w-3"})]})]}):(0,s.jsx)(v.C,{variant:"outline",className:"text-muted-foreground",children:"Not available"})}):(0,s.jsx)("span",{className:"text-muted-foreground",children:"-"})},r.id)})]},e.id)}),(0,s.jsxs)(w.SC,{className:"bg-muted/50",children:[(0,s.jsx)(w.pj,{colSpan:2,className:"font-bold",children:"Platform Totals"}),Array.isArray(P)&&P.map(e=>e?(0,s.jsx)(w.pj,{className:"font-bold",children:B[e.name]>0?(0,S.xG)(B[e.name]):(0,s.jsx)("span",{className:"text-muted-foreground",children:"-"})},e.id):null)]}),(0,s.jsxs)(w.SC,{children:[(0,s.jsx)(w.pj,{colSpan:2,className:"font-medium text-muted-foreground",children:"Items Available"}),Array.isArray(P)&&P.map(e=>{if(!e)return null;let r=Array.isArray(A)?A.filter(r=>r&&r.prices&&Array.isArray(r.prices)&&r.prices.some(r=>r&&r.platform===e.name&&r.available)).length:0,t=Array.isArray(A)?A.length:0;return(0,s.jsx)(w.pj,{children:r>0?(0,s.jsxs)(v.C,{variant:r===t?"success":"warning",children:[r,"/",t]}):(0,s.jsxs)(v.C,{variant:"outline",className:"text-muted-foreground",children:["0/",t]})},e.id)})]}),(0,s.jsxs)(w.SC,{children:[(0,s.jsx)(w.pj,{colSpan:2,className:"font-medium text-muted-foreground",children:"Delivery Fee"}),Array.isArray(P)&&P.map(e=>e?(0,s.jsx)(w.pj,{children:(0,S.xG)(e.deliveryFee||0)},e.id):null)]}),(0,s.jsxs)(w.SC,{children:[(0,s.jsx)(w.pj,{colSpan:2,className:"font-medium text-muted-foreground",children:"Min Order Value"}),Array.isArray(P)&&P.map(e=>e?(0,s.jsx)(w.pj,{children:(e.minOrderValue||0)>0?(0,S.xG)(e.minOrderValue||0):(0,s.jsx)("span",{className:"text-muted-foreground",children:"None"})},e.id):null)]})]})]})})}),(0,s.jsxs)(N.eW,{className:"flex justify-between",children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"* Prices include delivery fees where applicable"}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("span",{className:"mr-2 text-sm font-medium",children:"Best Value:"}),(0,s.jsxs)(v.C,{variant:"success",className:"flex items-center",children:["Optimized Shopping",(0,s.jsx)(f.Z,{className:"ml-1 h-3 w-3"})]})]})]})]})})]})})]}):(0,s.jsx)(N.Zb,{className:"bg-muted/50",children:(0,s.jsxs)(N.aY,{className:"pt-6 text-center",children:[(0,s.jsx)("p",{className:"mb-4",children:"No items in this shopping list yet."}),(0,s.jsx)(b.z,{asChild:!0,children:(0,s.jsxs)(n.default,{href:"/dashboard/lists/".concat(t),children:[(0,s.jsx)(u.Z,{className:"mr-2 h-4 w-4"}),"Go Back to Shopping List"]})})]})})}T.displayName=A.VY.displayName},1789:function(e,r,t){"use strict";t.d(r,{C:function(){return l}});var s=t(784);t(1960);var a=t(664),i=t(5518);let n=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-green-500 text-white hover:bg-green-600",warning:"border-transparent bg-yellow-500 text-white hover:bg-yellow-600",info:"border-transparent bg-blue-500 text-white hover:bg-blue-600"}},defaultVariants:{variant:"default"}});function l(e){let{className:r,variant:t,...a}=e;return(0,s.jsx)("div",{className:(0,i.cn)(n({variant:t}),r),...a})}},5796:function(e,r,t){"use strict";t.d(r,{z:function(){return c}});var s=t(784),a=t(1960),i=t(2310),n=t(664),l=t(5518);let o=(0,n.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",success:"bg-green-600 text-white hover:bg-green-700"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,r)=>{let{className:t,variant:a,size:n,asChild:c=!1,...d}=e,m=c?i.g7:"button";return(0,s.jsx)(m,{className:(0,l.cn)(o({variant:a,size:n,className:t})),ref:r,...d})});c.displayName="Button"},9026:function(e,r,t){"use strict";t.d(r,{Ol:function(){return l},SZ:function(){return c},Zb:function(){return n},aY:function(){return d},eW:function(){return m},ll:function(){return o}});var s=t(784),a=t(1960),i=t(5518);let n=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm transition-all hover:shadow-md",t),...a})});n.displayName="Card";let l=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",t),...a})});l.displayName="CardHeader";let o=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("h3",{ref:r,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",t),...a})});o.displayName="CardTitle";let c=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("p",{ref:r,className:(0,i.cn)("text-sm text-muted-foreground",t),...a})});c.displayName="CardDescription";let d=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,i.cn)("p-6 pt-0",t),...a})});d.displayName="CardContent";let m=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,i.cn)("flex items-center p-6 pt-0",t),...a})});m.displayName="CardFooter"},4428:function(e,r,t){"use strict";t.d(r,{RM:function(){return o},SC:function(){return c},iA:function(){return n},pj:function(){return m},ss:function(){return d},xD:function(){return l}});var s=t(784),a=t(1960),i=t(5518);let n=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:"relative w-full overflow-auto",children:(0,s.jsx)("table",{ref:r,className:(0,i.cn)("w-full caption-bottom text-sm",t),...a})})});n.displayName="Table";let l=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("thead",{ref:r,className:(0,i.cn)("[&_tr]:border-b",t),...a})});l.displayName="TableHeader";let o=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("tbody",{ref:r,className:(0,i.cn)("[&_tr:last-child]:border-0",t),...a})});o.displayName="TableBody",a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("tfoot",{ref:r,className:(0,i.cn)("bg-primary font-medium text-primary-foreground",t),...a})}).displayName="TableFooter";let c=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("tr",{ref:r,className:(0,i.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...a})});c.displayName="TableRow";let d=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("th",{ref:r,className:(0,i.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...a})});d.displayName="TableHead";let m=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("td",{ref:r,className:(0,i.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...a})});m.displayName="TableCell",a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("caption",{ref:r,className:(0,i.cn)("mt-4 text-sm text-muted-foreground",t),...a})}).displayName="TableCaption"},395:function(e,r,t){"use strict";t.d(r,{pm:function(){return f}});var s=t(1960);let a=0,i=new Map,n=e=>{if(i.has(e))return;let r=setTimeout(()=>{i.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);i.set(e,r)},l=(e,r)=>{switch(r.type){case"ADD_TOAST":return{...e,toasts:[r.toast,...e.toasts].slice(0,5)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===r.toast.id?{...e,...r.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=r;return t?n(t):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===r.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==r.toastId)}}},o=[],c={toasts:[]};function d(e){c=l(c,e),o.forEach(e=>{e(c)})}function m(e){let{...r}=e,t=(a=(a+1)%Number.MAX_VALUE).toString(),s=()=>d({type:"DISMISS_TOAST",toastId:t});return d({type:"ADD_TOAST",toast:{...r,id:t,open:!0,onOpenChange:e=>{e||s()}}}),{id:t,dismiss:s,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function f(){let[e,r]=s.useState(c);return s.useEffect(()=>(o.push(r),()=>{let e=o.indexOf(r);e>-1&&o.splice(e,1)}),[e]),{...e,toast:m,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},5518:function(e,r,t){"use strict";t.d(r,{cn:function(){return i},np:function(){return l},xG:function(){return n}});var s=t(3201),a=t(3298);function i(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,a.m6)((0,s.W)(r))}function n(e){if(null==e||isNaN(e))return"₹0.00";try{return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:2}).format(e)}catch(r){return console.error("Error formatting currency:",r),"₹".concat(e.toFixed(2))}}function l(e){console.log("Optimizing shopping list with items:",e?e.length:0);let r={platformItems:{},savings:0,totalCost:0,originalCost:0};if(!e||!Array.isArray(e)||0===e.length)return console.log("No valid items to optimize"),r;try{var t,s;let a=new Set,i=0;return e.forEach(e=>{if(!e||!e.prices||!Array.isArray(e.prices)||0===e.prices.length){console.log("Skipping item with no valid prices:",null==e?void 0:e.name);return}let t=e.prices.filter(e=>e&&e.available&&"number"==typeof e.price&&!isNaN(e.price));if(0===t.length){console.log("No available prices for item:",e.name);return}t.forEach(e=>{e&&e.platform&&a.add(e.platform)});let s=t.reduce((e,r)=>e&&r?"number"!=typeof e.price||"number"!=typeof r.price?"number"==typeof e.price?e:r:r.price<e.price?r:e:e||r,t[0]);if(s&&"number"==typeof s.price&&!isNaN(s.price)){let t="number"!=typeof e.quantity||isNaN(e.quantity)?1:e.quantity;r.totalCost+=s.price*t}}),console.log("Identified platforms:",Array.from(a)),console.log("Initial optimized cost:",r.totalCost),Array.from(a).forEach(r=>{if(!r)return;let t=0,s=0;e.forEach(e=>{if(!e||!e.prices||!Array.isArray(e.prices))return;let a=e.prices.find(e=>e&&e.platform===r&&e.available&&"number"==typeof e.price&&!isNaN(e.price));if(a){let r="number"!=typeof e.quantity||isNaN(e.quantity)?1:e.quantity;t+=a.price*r,s++}});let a=e.filter(e=>e&&e.prices&&Array.isArray(e.prices)&&e.prices.length>0);s===a.length&&s>0&&(0===i||t<i)&&(i=t,console.log("New best single platform: ".concat(r," with cost: ").concat(i)))}),r.originalCost=i>0?i:r.totalCost,r.savings=(t=r.originalCost,s=r.totalCost,"number"!=typeof t||"number"!=typeof s||isNaN(t)||isNaN(s)?0:Math.max(0,t-s)),console.log("Original cost: ".concat(r.originalCost,", Optimized cost: ").concat(r.totalCost,", Savings: ").concat(r.savings)),e.forEach(e=>{if(!e||!e.prices||!Array.isArray(e.prices)||0===e.prices.length)return;let t=e.prices.filter(e=>e&&e.available&&"number"==typeof e.price&&!isNaN(e.price));if(0===t.length)return;let s=t.reduce((e,r)=>e&&r?"number"!=typeof e.price||"number"!=typeof r.price?"number"==typeof e.price?e:r:r.price<e.price?r:e:e||r,t[0]);if(!s||!s.platform)return;let a=s.platform;r.platformItems[a]||(r.platformItems[a]=[]),r.platformItems[a].push({...e,bestPrice:s})}),console.log("Optimized shopping across ".concat(Object.keys(r.platformItems).length," platforms")),r}catch(e){return console.error("Error in optimizeShoppingList:",e),r}}}},function(e){e.O(0,[374,965,264,852,870,427,275,744],function(){return e(e.s=5865)}),_N_E=e.O()}]);