(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[465],{2888:function(e,t,r){Promise.resolve().then(r.bind(r,3970)),Promise.resolve().then(r.t.bind(r,1965,23))},3970:function(e,t,r){"use strict";r.d(t,{ShoppingListItems:function(){return N}});var s=r(784),n=r(1960),i=r(3866),a=r(6070),o=r(5762),l=r(500),c=r(4705),d=r(5861),u=r(4131),f=r(6585),p=r(398),m=r(9218),h=r(395),x=r(3968),g=r(5796),y=r(9026),b=r(1789),v=r(4428);function N(e){let{listId:t}=e,[r,N]=(0,n.useState)([]),[j,w]=(0,n.useState)(!0),[S,A]=(0,n.useState)(!1),E=(0,i.useRouter)(),{toast:C}=(0,h.pm)(),{ref:T,inView:k}=(0,m.YD)({triggerOnce:!1,threshold:.1}),R=async()=>{try{w(!0);let e=await fetch("/api/shopping-lists/".concat(t,"/items"));if(!e.ok)throw Error("Failed to fetch items");let r=await e.json();N(r)}catch(e){console.error("Error fetching items:",e),C({title:"Error",description:"Failed to load items. Please refresh the page.",variant:"destructive"})}finally{w(!1)}};(0,n.useEffect)(()=>{R()},[t,C]);let I=async e=>{if(confirm("Are you sure you want to delete this item?"))try{if(!(await fetch("/api/shopping-lists/".concat(t,"/items/").concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete item");N(r.filter(t=>t.id!==e)),C({title:"Success",description:"Item deleted successfully"})}catch(e){console.error("Error deleting item:",e),C({title:"Error",description:"Failed to delete item",variant:"destructive"})}},O=async()=>{A(!0);try{if(!(await fetch("/api/shopping-lists/".concat(t,"/refresh-prices"),{method:"POST"})).ok)throw Error("Failed to refresh prices");await R(),C({title:"Success",description:"Prices refreshed with real-time data"})}catch(e){console.error("Error refreshing prices:",e),C({title:"Error",description:"Failed to refresh prices",variant:"destructive"})}finally{A(!1)}},D=e=>{if(!e||0===e.length)return null;let t=e.filter(e=>e.available);return 0===t.length?null:t.reduce((e,t)=>t.price<e.price?t:e,t[0])},Z=e=>{if(!e||0===e.length)return null;let t=e.reduce((e,t)=>new Date(t.lastUpdated)>new Date(e||0)?t.lastUpdated:e,null);return t?(0,x.Q)(new Date(t),{addSuffix:!0}):"Never"};return j?(0,s.jsx)("div",{className:"flex justify-center items-center h-40",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("h2",{className:"text-2xl font-bold flex items-center",children:[(0,s.jsx)(o.Z,{className:"mr-2 h-6 w-6 text-primary"}),"Shopping List Items"]}),(0,s.jsxs)(g.z,{onClick:O,disabled:S,variant:"outline",children:[(0,s.jsx)(l.Z,{className:"mr-2 h-4 w-4 ".concat(S?"animate-spin":"")}),S?"Refreshing...":"Refresh Prices"]})]}),0===r.length?(0,s.jsx)(y.Zb,{className:"bg-muted/50",children:(0,s.jsxs)(y.aY,{className:"pt-6 text-center",children:[(0,s.jsx)("p",{className:"mb-4",children:"No items in this shopping list yet."}),(0,s.jsxs)(g.z,{onClick:()=>E.push("/dashboard/lists/".concat(t,"/add-item")),children:[(0,s.jsx)(c.Z,{className:"mr-2 h-4 w-4"}),"Add Your First Item"]})]})}):(0,s.jsx)(a.E.div,{ref:T,variants:{hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},initial:"hidden",animate:k?"show":"hidden",children:(0,s.jsxs)(y.Zb,{children:[(0,s.jsx)(y.Ol,{children:(0,s.jsxs)(y.ll,{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(d.Z,{className:"h-5 w-5 mr-2 text-primary"}),(0,s.jsxs)("span",{children:["Items (",r.length,")"]})]}),(0,s.jsx)("div",{children:(0,s.jsxs)(g.z,{size:"sm",onClick:()=>{try{E.push("/dashboard/lists/".concat(t,"/compare"))}catch(e){console.error("Navigation error:",e),C({title:"Navigation Error",description:"Failed to navigate to comparison page. Please try again.",variant:"destructive"})}},children:[(0,s.jsx)(u.Z,{className:"mr-2 h-4 w-4"}),"Compare & Optimize"]})})]})}),(0,s.jsx)(y.aY,{children:(0,s.jsxs)(v.iA,{children:[(0,s.jsx)(v.xD,{children:(0,s.jsxs)(v.SC,{children:[(0,s.jsx)(v.ss,{children:"Item"}),(0,s.jsx)(v.ss,{children:"Quantity"}),(0,s.jsx)(v.ss,{children:"Best Price"}),(0,s.jsx)(v.ss,{children:"Platform"}),(0,s.jsx)(v.ss,{children:"Last Updated"}),(0,s.jsx)(v.ss,{className:"text-right",children:"Actions"})]})}),(0,s.jsx)(v.RM,{children:r.map(e=>{let t=D(e.prices),r=Z(e.prices);return(0,s.jsxs)(v.SC,{children:[(0,s.jsx)(v.pj,{className:"font-medium",children:e.name}),(0,s.jsxs)(v.pj,{children:[e.quantity," ",e.unit&&(0,s.jsx)("span",{className:"text-muted-foreground",children:e.unit})]}),(0,s.jsx)(v.pj,{children:t?(0,s.jsxs)("span",{className:"font-medium",children:["₹",t.price.toFixed(2)]}):(0,s.jsx)(b.C,{variant:"outline",children:"No price data"})}),(0,s.jsx)(v.pj,{children:t?(0,s.jsx)(b.C,{children:t.platform}):(0,s.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,s.jsx)(v.pj,{children:(0,s.jsxs)("div",{className:"flex items-center text-xs text-muted-foreground",children:[(0,s.jsx)(f.Z,{className:"h-3 w-3 mr-1"}),r]})}),(0,s.jsx)(v.pj,{className:"text-right",children:(0,s.jsxs)(g.z,{variant:"ghost",size:"sm",onClick:()=>I(e.id),children:[(0,s.jsx)(p.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Delete"})]})})]},e.id)})})]})})]})})]})}},1789:function(e,t,r){"use strict";r.d(t,{C:function(){return o}});var s=r(784);r(1960);var n=r(664),i=r(5518);let a=(0,n.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-green-500 text-white hover:bg-green-600",warning:"border-transparent bg-yellow-500 text-white hover:bg-yellow-600",info:"border-transparent bg-blue-500 text-white hover:bg-blue-600"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:r,...n}=e;return(0,s.jsx)("div",{className:(0,i.cn)(a({variant:r}),t),...n})}},5796:function(e,t,r){"use strict";r.d(t,{z:function(){return c}});var s=r(784),n=r(1960),i=r(2310),a=r(664),o=r(5518);let l=(0,a.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",success:"bg-green-600 text-white hover:bg-green-700"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=n.forwardRef((e,t)=>{let{className:r,variant:n,size:a,asChild:c=!1,...d}=e,u=c?i.g7:"button";return(0,s.jsx)(u,{className:(0,o.cn)(l({variant:n,size:a,className:r})),ref:t,...d})});c.displayName="Button"},9026:function(e,t,r){"use strict";r.d(t,{Ol:function(){return o},SZ:function(){return c},Zb:function(){return a},aY:function(){return d},eW:function(){return u},ll:function(){return l}});var s=r(784),n=r(1960),i=r(5518);let a=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm transition-all hover:shadow-md",r),...n})});a.displayName="Card";let o=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",r),...n})});o.displayName="CardHeader";let l=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("h3",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",r),...n})});l.displayName="CardTitle";let c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("p",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",r),...n})});c.displayName="CardDescription";let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",r),...n})});d.displayName="CardContent";let u=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",r),...n})});u.displayName="CardFooter"},4428:function(e,t,r){"use strict";r.d(t,{RM:function(){return l},SC:function(){return c},iA:function(){return a},pj:function(){return u},ss:function(){return d},xD:function(){return o}});var s=r(784),n=r(1960),i=r(5518);let a=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{className:"relative w-full overflow-auto",children:(0,s.jsx)("table",{ref:t,className:(0,i.cn)("w-full caption-bottom text-sm",r),...n})})});a.displayName="Table";let o=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("thead",{ref:t,className:(0,i.cn)("[&_tr]:border-b",r),...n})});o.displayName="TableHeader";let l=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("tbody",{ref:t,className:(0,i.cn)("[&_tr:last-child]:border-0",r),...n})});l.displayName="TableBody",n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("tfoot",{ref:t,className:(0,i.cn)("bg-primary font-medium text-primary-foreground",r),...n})}).displayName="TableFooter";let c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("tr",{ref:t,className:(0,i.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...n})});c.displayName="TableRow";let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("th",{ref:t,className:(0,i.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...n})});d.displayName="TableHead";let u=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("td",{ref:t,className:(0,i.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...n})});u.displayName="TableCell",n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("caption",{ref:t,className:(0,i.cn)("mt-4 text-sm text-muted-foreground",r),...n})}).displayName="TableCaption"},395:function(e,t,r){"use strict";r.d(t,{pm:function(){return f}});var s=r(1960);let n=0,i=new Map,a=e=>{if(i.has(e))return;let t=setTimeout(()=>{i.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);i.set(e,t)},o=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,5)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?a(r):e.toasts.forEach(e=>{a(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],c={toasts:[]};function d(e){c=o(c,e),l.forEach(e=>{e(c)})}function u(e){let{...t}=e,r=(n=(n+1)%Number.MAX_VALUE).toString(),s=()=>d({type:"DISMISS_TOAST",toastId:r});return d({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||s()}}}),{id:r,dismiss:s,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function f(){let[e,t]=s.useState(c);return s.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},5518:function(e,t,r){"use strict";r.d(t,{cn:function(){return i},np:function(){return o},xG:function(){return a}});var s=r(3201),n=r(3298);function i(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.m6)((0,s.W)(t))}function a(e){if(null==e||isNaN(e))return"₹0.00";try{return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:2}).format(e)}catch(t){return console.error("Error formatting currency:",t),"₹".concat(e.toFixed(2))}}function o(e){console.log("Optimizing shopping list with items:",e?e.length:0);let t={platformItems:{},savings:0,totalCost:0,originalCost:0};if(!e||!Array.isArray(e)||0===e.length)return console.log("No valid items to optimize"),t;try{var r,s;let n=new Set,i=0;return e.forEach(e=>{if(!e||!e.prices||!Array.isArray(e.prices)||0===e.prices.length){console.log("Skipping item with no valid prices:",null==e?void 0:e.name);return}let r=e.prices.filter(e=>e&&e.available&&"number"==typeof e.price&&!isNaN(e.price));if(0===r.length){console.log("No available prices for item:",e.name);return}r.forEach(e=>{e&&e.platform&&n.add(e.platform)});let s=r.reduce((e,t)=>e&&t?"number"!=typeof e.price||"number"!=typeof t.price?"number"==typeof e.price?e:t:t.price<e.price?t:e:e||t,r[0]);if(s&&"number"==typeof s.price&&!isNaN(s.price)){let r="number"!=typeof e.quantity||isNaN(e.quantity)?1:e.quantity;t.totalCost+=s.price*r}}),console.log("Identified platforms:",Array.from(n)),console.log("Initial optimized cost:",t.totalCost),Array.from(n).forEach(t=>{if(!t)return;let r=0,s=0;e.forEach(e=>{if(!e||!e.prices||!Array.isArray(e.prices))return;let n=e.prices.find(e=>e&&e.platform===t&&e.available&&"number"==typeof e.price&&!isNaN(e.price));if(n){let t="number"!=typeof e.quantity||isNaN(e.quantity)?1:e.quantity;r+=n.price*t,s++}});let n=e.filter(e=>e&&e.prices&&Array.isArray(e.prices)&&e.prices.length>0);s===n.length&&s>0&&(0===i||r<i)&&(i=r,console.log("New best single platform: ".concat(t," with cost: ").concat(i)))}),t.originalCost=i>0?i:t.totalCost,t.savings=(r=t.originalCost,s=t.totalCost,"number"!=typeof r||"number"!=typeof s||isNaN(r)||isNaN(s)?0:Math.max(0,r-s)),console.log("Original cost: ".concat(t.originalCost,", Optimized cost: ").concat(t.totalCost,", Savings: ").concat(t.savings)),e.forEach(e=>{if(!e||!e.prices||!Array.isArray(e.prices)||0===e.prices.length)return;let r=e.prices.filter(e=>e&&e.available&&"number"==typeof e.price&&!isNaN(e.price));if(0===r.length)return;let s=r.reduce((e,t)=>e&&t?"number"!=typeof e.price||"number"!=typeof t.price?"number"==typeof e.price?e:t:t.price<e.price?t:e:e||t,r[0]);if(!s||!s.platform)return;let n=s.platform;t.platformItems[n]||(t.platformItems[n]=[]),t.platformItems[n].push({...e,bestPrice:s})}),console.log("Optimized shopping across ".concat(Object.keys(t.platformItems).length," platforms")),t}catch(e){return console.error("Error in optimizeShoppingList:",e),t}}},5762:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(6382).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},4705:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(6382).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},398:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(6382).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},3866:function(e,t,r){"use strict";var s=r(490);r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})}},function(e){e.O(0,[374,965,264,427,275,744],function(){return e(e.s=2888)}),_N_E=e.O()}]);