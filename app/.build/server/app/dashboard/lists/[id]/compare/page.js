(()=>{var e={};e.id=188,e.ids=[188],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},2565:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>c,routeModule:()=>f,tree:()=>d}),t(5662),t(9910),t(6289);var s=t(2752),a=t(7380),i=t(459),n=t.n(i),l=t(8119),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);t.d(r,o);let d=["",{children:["dashboard",{children:["lists",{children:["[id]",{children:["compare",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,5662)),"/home/ubuntu/grocery_price_comparison/app/app/dashboard/lists/[id]/compare/page.tsx"]}]},{}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,9910)),"/home/ubuntu/grocery_price_comparison/app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,6289,23)),"next/dist/client/components/not-found-error"]}],c=["/home/ubuntu/grocery_price_comparison/app/app/dashboard/lists/[id]/compare/page.tsx"],m="/dashboard/lists/[id]/compare/page",u={require:t,loadChunk:()=>Promise.resolve()},f=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/lists/[id]/compare/page",pathname:"/dashboard/lists/[id]/compare",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},8752:(e,r,t)=>{Promise.resolve().then(t.bind(t,1174)),Promise.resolve().then(t.t.bind(t,5552,23))},1174:(e,r,t)=>{"use strict";t.d(r,{PriceComparison:()=>ew});var s=t(4848),a=t(5642),i=t.t(a,2),n=t(6953),l=t.n(n),o=t(4334),d=t(9631),c=t(7657),m=t(2333),u=t(93);let f=(0,u.Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var x=t(1606);let p=(0,u.Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var h=t(9950);let g=(0,u.Z)("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);var j=t(1788);let b=(0,u.Z)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),y=(0,u.Z)("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);var v=t(4956),N=t(1932),w=t(8287),A=t(391),C=t(4857),S=t(151),k=t(6654),P=t(9185),R=t(3672),E=t(8532),I=t(453),T=i["useId".toString()]||(()=>void 0),_=0;function F(e){let[r,t]=a.useState(T());return(0,I.b)(()=>{e||t(e=>e??String(_++))},[e]),e||(r?`radix-${r}`:"")}var M=t(6443),z=t(323),Z=t(1053),O=a.createContext(void 0);function D(e){let r=a.useContext(O);return e||r||"ltr"}var G="rovingFocusGroup.onEntryFocus",q={bubbles:!1,cancelable:!0},V="RovingFocusGroup",[$,L,B]=(0,R.B)(V),[U,Y]=(0,P.b)(V,[B]),[W,K]=U(V),H=a.forwardRef((e,r)=>(0,s.jsx)($.Provider,{scope:e.__scopeRovingFocusGroup,children:(0,s.jsx)($.Slot,{scope:e.__scopeRovingFocusGroup,children:(0,s.jsx)(Q,{...e,ref:r})})}));H.displayName=V;var Q=a.forwardRef((e,r)=>{let{__scopeRovingFocusGroup:t,orientation:i,loop:n=!1,dir:l,currentTabStopId:o,defaultCurrentTabStopId:d,onCurrentTabStopIdChange:c,onEntryFocus:m,preventScrollOnEntryFocus:u=!1,...f}=e,x=a.useRef(null),p=(0,E.e)(r,x),h=D(l),[g=null,j]=(0,Z.T)({prop:o,defaultProp:d,onChange:c}),[b,y]=a.useState(!1),v=(0,z.W)(m),N=L(t),w=a.useRef(!1),[A,C]=a.useState(0);return a.useEffect(()=>{let e=x.current;if(e)return e.addEventListener(G,v),()=>e.removeEventListener(G,v)},[v]),(0,s.jsx)(W,{scope:t,orientation:i,dir:h,loop:n,currentTabStopId:g,onItemFocus:a.useCallback(e=>j(e),[j]),onItemShiftTab:a.useCallback(()=>y(!0),[]),onFocusableItemAdd:a.useCallback(()=>C(e=>e+1),[]),onFocusableItemRemove:a.useCallback(()=>C(e=>e-1),[]),children:(0,s.jsx)(M.WV.div,{tabIndex:b||0===A?-1:0,"data-orientation":i,...f,ref:p,style:{outline:"none",...e.style},onMouseDown:(0,k.M)(e.onMouseDown,()=>{w.current=!0}),onFocus:(0,k.M)(e.onFocus,e=>{let r=!w.current;if(e.target===e.currentTarget&&r&&!b){let r=new CustomEvent(G,q);if(e.currentTarget.dispatchEvent(r),!r.defaultPrevented){let e=N().filter(e=>e.focusable);er([e.find(e=>e.active),e.find(e=>e.id===g),...e].filter(Boolean).map(e=>e.ref.current),u)}}w.current=!1}),onBlur:(0,k.M)(e.onBlur,()=>y(!1))})})}),X="RovingFocusGroupItem",J=a.forwardRef((e,r)=>{let{__scopeRovingFocusGroup:t,focusable:i=!0,active:n=!1,tabStopId:l,...o}=e,d=F(),c=l||d,m=K(X,t),u=m.currentTabStopId===c,f=L(t),{onFocusableItemAdd:x,onFocusableItemRemove:p}=m;return a.useEffect(()=>{if(i)return x(),()=>p()},[i,x,p]),(0,s.jsx)($.ItemSlot,{scope:t,id:c,focusable:i,active:n,children:(0,s.jsx)(M.WV.span,{tabIndex:u?0:-1,"data-orientation":m.orientation,...o,ref:r,onMouseDown:(0,k.M)(e.onMouseDown,e=>{i?m.onItemFocus(c):e.preventDefault()}),onFocus:(0,k.M)(e.onFocus,()=>m.onItemFocus(c)),onKeyDown:(0,k.M)(e.onKeyDown,e=>{if("Tab"===e.key&&e.shiftKey){m.onItemShiftTab();return}if(e.target!==e.currentTarget)return;let r=function(e,r,t){var s;let a=(s=e.key,"rtl"!==t?s:"ArrowLeft"===s?"ArrowRight":"ArrowRight"===s?"ArrowLeft":s);if(!("vertical"===r&&["ArrowLeft","ArrowRight"].includes(a))&&!("horizontal"===r&&["ArrowUp","ArrowDown"].includes(a)))return ee[a]}(e,m.orientation,m.dir);if(void 0!==r){if(e.metaKey||e.ctrlKey||e.altKey||e.shiftKey)return;e.preventDefault();let t=f().filter(e=>e.focusable).map(e=>e.ref.current);if("last"===r)t.reverse();else if("prev"===r||"next"===r){"prev"===r&&t.reverse();let s=t.indexOf(e.currentTarget);t=m.loop?function(e,r){return e.map((t,s)=>e[(r+s)%e.length])}(t,s+1):t.slice(s+1)}setTimeout(()=>er(t))}})})})});J.displayName=X;var ee={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function er(e,r=!1){let t=document.activeElement;for(let s of e)if(s===t||(s.focus({preventScroll:r}),document.activeElement!==t))return}var et=t(8319),es="Tabs",[ea,ei]=(0,P.b)(es,[Y]),en=Y(),[el,eo]=ea(es),ed=a.forwardRef((e,r)=>{let{__scopeTabs:t,value:a,onValueChange:i,defaultValue:n,orientation:l="horizontal",dir:o,activationMode:d="automatic",...c}=e,m=D(o),[u,f]=(0,Z.T)({prop:a,onChange:i,defaultProp:n});return(0,s.jsx)(el,{scope:t,baseId:F(),value:u,onValueChange:f,orientation:l,dir:m,activationMode:d,children:(0,s.jsx)(M.WV.div,{dir:m,"data-orientation":l,...c,ref:r})})});ed.displayName=es;var ec="TabsList",em=a.forwardRef((e,r)=>{let{__scopeTabs:t,loop:a=!0,...i}=e,n=eo(ec,t),l=en(t);return(0,s.jsx)(H,{asChild:!0,...l,orientation:n.orientation,dir:n.dir,loop:a,children:(0,s.jsx)(M.WV.div,{role:"tablist","aria-orientation":n.orientation,...i,ref:r})})});em.displayName=ec;var eu="TabsTrigger",ef=a.forwardRef((e,r)=>{let{__scopeTabs:t,value:a,disabled:i=!1,...n}=e,l=eo(eu,t),o=en(t),d=eh(l.baseId,a),c=eg(l.baseId,a),m=a===l.value;return(0,s.jsx)(J,{asChild:!0,...o,focusable:!i,active:m,children:(0,s.jsx)(M.WV.button,{type:"button",role:"tab","aria-selected":m,"aria-controls":c,"data-state":m?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:d,...n,ref:r,onMouseDown:(0,k.M)(e.onMouseDown,e=>{i||0!==e.button||!1!==e.ctrlKey?e.preventDefault():l.onValueChange(a)}),onKeyDown:(0,k.M)(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&l.onValueChange(a)}),onFocus:(0,k.M)(e.onFocus,()=>{let e="manual"!==l.activationMode;m||i||!e||l.onValueChange(a)})})})});ef.displayName=eu;var ex="TabsContent",ep=a.forwardRef((e,r)=>{let{__scopeTabs:t,value:i,forceMount:n,children:l,...o}=e,d=eo(ex,t),c=eh(d.baseId,i),m=eg(d.baseId,i),u=i===d.value,f=a.useRef(u);return a.useEffect(()=>{let e=requestAnimationFrame(()=>f.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,s.jsx)(et.z,{present:n||u,children:({present:t})=>(0,s.jsx)(M.WV.div,{"data-state":u?"active":"inactive","data-orientation":d.orientation,role:"tabpanel","aria-labelledby":c,hidden:!t,id:m,tabIndex:0,...o,ref:r,style:{...e.style,animationDuration:f.current?"0s":void 0},children:t&&l})})});function eh(e,r){return`${e}-trigger-${r}`}function eg(e,r){return`${e}-content-${r}`}ep.displayName=ex;var ej=t(5709);let eb=a.forwardRef(({className:e,...r},t)=>s.jsx(em,{ref:t,className:(0,ej.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...r}));eb.displayName=em.displayName;let ey=a.forwardRef(({className:e,...r},t)=>s.jsx(ef,{ref:t,className:(0,ej.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...r}));ey.displayName=ef.displayName;let ev=a.forwardRef(({className:e,...r},t)=>s.jsx(ep,{ref:t,className:(0,ej.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...r}));function eN({children:e,content:r,side:t="top",align:i="center"}){let[n,l]=a.useState(!1),[o,d]=a.useState({x:0,y:0}),c=a.useRef(null);return(0,s.jsxs)("div",{className:"relative inline-block",children:[s.jsx("div",{ref:c,onMouseEnter:()=>{if(c.current){let e=c.current.getBoundingClientRect(),r=e.left+e.width/2,s=e.top;"bottom"===t?s=e.bottom:"left"===t?(r=e.left,s=e.top+e.height/2):"right"===t&&(r=e.right,s=e.top+e.height/2),"start"===i?"top"===t||"bottom"===t?r=e.left:s=e.top:"end"===i&&("top"===t||"bottom"===t?r=e.right:s=e.bottom),d({x:r,y:s})}l(!0)},onMouseLeave:()=>{l(!1)},className:"inline-flex cursor-help",children:e}),n&&s.jsx("div",{className:"fixed z-50 px-3 py-1.5 text-xs font-medium text-white bg-gray-900 rounded-md shadow-sm dark:bg-gray-700 animate-in fade-in-0 zoom-in-95",style:{transform:`translate(${"left"===t?"-100%":"right"===t?"0":"-50%"}, ${"top"===t?"-100%":"bottom"===t?"0":"-50%"})`,left:`${o.x}px`,top:`${o.y}px`},children:r})]})}function ew({listId:e}){let[r,t]=(0,a.useState)([]),[i,n]=(0,a.useState)([]),[u,k]=(0,a.useState)(!0),[P,R]=(0,a.useState)(!1),[E,I]=(0,a.useState)(null),{toast:T}=(0,N.pm)(),{ref:_,inView:F}=(0,c.YD)({triggerOnce:!1,threshold:.1}),M=async()=>{try{I(null),console.log("Fetching items for list:",e);let r=await fetch(`/api/shopping-lists/${e}/items`);if(!r.ok)throw Error(`Failed to fetch items: ${r.status} ${r.statusText}`);let s=await r.json();console.log("Items data received:",s),t(Array.isArray(s)?s:[]),console.log("Fetching platform info");let a=await fetch("/api/platforms");if(!a.ok)throw Error(`Failed to fetch platform information: ${a.status} ${a.statusText}`);let i=await a.json();console.log("Platform data received:",i),n(Array.isArray(i)?i:[])}catch(e){console.error("Error fetching data:",e),I(e instanceof Error?e.message:"An unknown error occurred"),T({title:"Error",description:"Failed to load data. Please refresh the page.",variant:"destructive"})}finally{k(!1)}},z=async()=>{R(!0),I(null);try{console.log("Refreshing prices for list:",e);let r=await fetch(`/api/shopping-lists/${e}/refresh-prices`,{method:"POST"});if(!r.ok)throw Error(`Failed to refresh prices: ${r.status} ${r.statusText}`);await M(),T({title:"Success",description:"Prices refreshed with real-time data from all platforms"})}catch(e){console.error("Error refreshing prices:",e),I(e instanceof Error?e.message:"An unknown error occurred"),T({title:"Error",description:"Failed to refresh prices. Please try again.",variant:"destructive"})}finally{R(!1)}},Z={hidden:{opacity:0,y:20},show:{opacity:1,y:0}},{platformTotals:O,platformItems:D}=(()=>{let e={},t={};return Array.isArray(i)&&i.forEach(r=>{r&&r.name&&(e[r.name]=0,t[r.name]=[])}),Array.isArray(r)&&r.forEach(r=>{r&&r.prices&&Array.isArray(r.prices)&&r.prices.forEach(s=>{if(s&&s.platform&&s.available&&"number"==typeof s.price){let a=s.price*("number"==typeof r.quantity?r.quantity:1);"number"!=typeof e[s.platform]&&(e[s.platform]=0),e[s.platform]+=a,Array.isArray(t[s.platform])||(t[s.platform]=[]),t[s.platform].find(e=>e&&e.id===r.id)||t[s.platform].push({...r,prices:[s]})}})}),Array.isArray(i)&&i.forEach(r=>{if(r&&r.name&&"number"==typeof e[r.name]){let t=e[r.name];t>0&&t>=(r.minOrderValue||0)&&(e[r.name]+=r.deliveryFee||0)}}),{platformTotals:e,platformItems:t}})(),G=Object.entries(O).filter(([e,r])=>"number"==typeof r&&r>0).sort(([e,r],[t,s])=>r-s)[0]?.[0]||null,q=Array.isArray(r)?r.filter(e=>e&&e.prices&&Array.isArray(e.prices)&&e.prices.length>0):[],V=(0,ej.np)(q),$=V.totalCost;V.platformItems&&"object"==typeof V.platformItems&&Object.keys(V.platformItems).forEach(e=>{let r=Array.isArray(i)?i.find(r=>r&&r.name===e):void 0;if(r){let t=V.platformItems[e];Array.isArray(t)&&t.reduce((e,r)=>{if(!r)return e;let t=r.bestPrice;return e+(t&&"number"==typeof t.price?t.price:0)*("number"==typeof r.quantity?r.quantity:1)},0)>=(r.minOrderValue||0)&&($+=r.deliveryFee||0)}});let L=G&&"number"==typeof O[G]?O[G]:0,B=L>0?L-$:0,U=L>0?Math.round(B/L*100):0,Y=(()=>{let e=null;if(Array.isArray(r)&&r.forEach(r=>{r&&r.prices&&Array.isArray(r.prices)&&r.prices.forEach(r=>{if(r&&r.lastUpdated)try{let t=new Date(r.lastUpdated);(!e||t>e)&&(e=t)}catch(e){console.error("Error parsing date:",e)}})}),!e)return"Never";try{return(0,m.Q)(e,{addSuffix:!0})}catch(e){return console.error("Error formatting date:",e),"Unknown"}})(),W=e=>{if(!e||!e.prices||!Array.isArray(e.prices))return 0;let r=new Set;return e.prices.forEach(e=>{e&&e.platform&&e.available&&r.add(e.platform)}),r.size},K=Array.isArray(r)&&0!==r.length?Math.round(r.reduce((e,r)=>e+W(r),0)/r.length*10)/10:0;return u?s.jsx("div",{className:"flex justify-center items-center h-40",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):E?s.jsx(A.Zb,{className:"bg-red-50 dark:bg-red-900/20 border-red-200",children:(0,s.jsxs)(A.aY,{className:"pt-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx(f,{className:"h-6 w-6 text-red-600"}),s.jsx("h3",{className:"text-lg font-semibold text-red-700",children:"Error Loading Comparison"})]}),s.jsx("p",{className:"mb-4 text-red-600",children:E}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsxs)(w.z,{variant:"outline",onClick:M,children:[s.jsx(x.Z,{className:"mr-2 h-4 w-4"}),"Try Again"]}),s.jsx(w.z,{asChild:!0,children:(0,s.jsxs)(o.default,{href:`/dashboard/lists/${e}`,children:[s.jsx(p,{className:"mr-2 h-4 w-4"}),"Return to List"]})})]})]})}):Array.isArray(r)&&0!==r.length?(0,s.jsxs)(d.E.div,{ref:_,variants:{hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},initial:"hidden",animate:F?"show":"hidden",className:"space-y-8",children:[s.jsx(d.E.div,{variants:Z,children:(0,s.jsxs)(A.Zb,{className:"bg-gradient-to-br from-primary/10 to-primary/5",children:[s.jsx(A.Ol,{children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)(A.ll,{className:"flex items-center text-2xl",children:[s.jsx(g,{className:"mr-2 h-6 w-6 text-primary"}),"Price Comparison Summary"]}),(0,s.jsxs)(A.SZ,{children:["Compare prices across ",i.length," platforms and find the best deals"]})]}),(0,s.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground",children:[s.jsx(j.Z,{className:"h-4 w-4 mr-1"}),"Prices updated: ",Y,s.jsx(w.z,{onClick:z,disabled:P,variant:"ghost",size:"sm",className:"ml-2",children:s.jsx(x.Z,{className:`h-4 w-4 ${P?"animate-spin":""}`})})]})]})}),s.jsx(A.aY,{children:(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[(0,s.jsxs)(A.Zb,{className:"bg-white/50 dark:bg-gray-800/50",children:[s.jsx(A.Ol,{className:"pb-2",children:s.jsx(A.ll,{className:"text-lg",children:"Total Items"})}),s.jsx(A.aY,{children:s.jsx("div",{className:"text-3xl font-bold",children:r.length})})]}),(0,s.jsxs)(A.Zb,{className:"bg-white/50 dark:bg-gray-800/50",children:[s.jsx(A.Ol,{className:"pb-2",children:(0,s.jsxs)(A.ll,{className:"text-lg flex items-center",children:["Platforms Per Item",s.jsx(eN,{content:"Average number of platforms with prices for each item",children:s.jsx(b,{className:"h-4 w-4 ml-1 text-muted-foreground"})})]})}),(0,s.jsxs)(A.aY,{children:[s.jsx("div",{className:"text-3xl font-bold",children:K}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:["out of ",i.length," platforms"]})]})]}),(0,s.jsxs)(A.Zb,{className:"bg-white/50 dark:bg-gray-800/50",children:[s.jsx(A.Ol,{className:"pb-2",children:s.jsx(A.ll,{className:"text-lg",children:"Best Single Platform"})}),s.jsx(A.aY,{children:G?(0,s.jsxs)("div",{children:[s.jsx("div",{className:"text-xl font-bold",children:G}),s.jsx("div",{className:"text-lg",children:(0,ej.xG)(O[G])})]}):s.jsx("div",{className:"text-muted-foreground",children:"No data available"})})]}),(0,s.jsxs)(A.Zb,{className:"bg-green-50 dark:bg-green-900/20",children:[s.jsx(A.Ol,{className:"pb-2",children:(0,s.jsxs)(A.ll,{className:"text-lg flex items-center",children:[s.jsx(y,{className:"mr-2 h-4 w-4 text-green-600"}),"Optimized Shopping"]})}),(0,s.jsxs)(A.aY,{children:[s.jsx("div",{className:"text-xl font-bold text-green-600",children:(0,ej.xG)($)}),B>0&&(0,s.jsxs)("div",{className:"flex items-center mt-1",children:[(0,s.jsxs)(C.C,{variant:"success",className:"mr-2",children:["Save ",U,"%"]}),s.jsx("span",{className:"text-sm text-green-600",children:(0,ej.xG)(B)})]})]})]})]})})]})}),s.jsx(d.E.div,{variants:Z,children:(0,s.jsxs)(ed,{defaultValue:"optimized",children:[(0,s.jsxs)(eb,{className:"grid w-full grid-cols-2",children:[s.jsx(ey,{value:"optimized",children:"Optimized Shopping"}),s.jsx(ey,{value:"comparison",children:"Platform Comparison"})]}),s.jsx(ev,{value:"optimized",className:"mt-4",children:(0,s.jsxs)(A.Zb,{children:[(0,s.jsxs)(A.Ol,{children:[(0,s.jsxs)(A.ll,{className:"flex items-center",children:[s.jsx(y,{className:"mr-2 h-5 w-5 text-primary"}),"Optimized Shopping Plan"]}),s.jsx(A.SZ,{children:"Split your shopping across these platforms to save money"})]}),s.jsx(A.aY,{children:V.platformItems&&"object"==typeof V.platformItems&&Object.keys(V.platformItems).length>0?(0,s.jsxs)("div",{className:"space-y-6",children:[Object.entries(V.platformItems).map(([e,r])=>{if(!Array.isArray(r)||0===r.length)return null;let t=Array.isArray(i)?i.find(r=>r&&r.name===e):void 0,a=r.reduce((e,r)=>{if(!r)return e;let t=r.bestPrice;return e+(t&&"number"==typeof t.price?t.price:0)*("number"==typeof r.quantity?r.quantity:1)},0);return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[t?.logoUrl?s.jsx("div",{className:"w-8 h-8 mr-2 relative overflow-hidden rounded",children:s.jsx(l(),{src:t.logoUrl,alt:e,fill:!0,className:"object-contain"})}):s.jsx(C.C,{className:"mr-2",children:e}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:[r.length," ",1===r.length?"item":"items"]})]}),(0,s.jsxs)("div",{className:"text-right",children:[s.jsx("div",{className:"font-medium",children:(0,ej.xG)(a)}),t&&(0,s.jsxs)("div",{className:"text-xs text-muted-foreground",children:["+ ",(0,ej.xG)(t.deliveryFee||0)," delivery",(t.minOrderValue||0)>0&&s.jsx("span",{children:a<(t.minOrderValue||0)?` (min order: ${(0,ej.xG)(t.minOrderValue||0)})`:""})]})]})]}),(0,s.jsxs)(S.iA,{children:[s.jsx(S.xD,{children:(0,s.jsxs)(S.SC,{children:[s.jsx(S.ss,{children:"Item"}),s.jsx(S.ss,{children:"Quantity"}),s.jsx(S.ss,{children:"Price"}),s.jsx(S.ss,{className:"text-right",children:"Total"})]})}),(0,s.jsxs)(S.RM,{children:[r.map(e=>e?(0,s.jsxs)(S.SC,{children:[s.jsx(S.pj,{className:"font-medium",children:e.name||"Unknown Item"}),(0,s.jsxs)(S.pj,{children:["number"==typeof e.quantity?e.quantity:1,e.unit&&s.jsx("span",{className:"text-muted-foreground",children:e.unit})]}),s.jsx(S.pj,{children:e.bestPrice&&"number"==typeof e.bestPrice.price?(0,ej.xG)(e.bestPrice.price):"N/A"}),s.jsx(S.pj,{className:"text-right",children:e.bestPrice&&"number"==typeof e.bestPrice.price?(0,ej.xG)(e.bestPrice.price*("number"==typeof e.quantity?e.quantity:1)):"N/A"})]},e.id):null),(0,s.jsxs)(S.SC,{children:[s.jsx(S.pj,{colSpan:3,className:"text-right font-medium",children:"Subtotal"}),s.jsx(S.pj,{className:"text-right font-medium",children:(0,ej.xG)(a)})]}),t&&(0,s.jsxs)(S.SC,{children:[s.jsx(S.pj,{colSpan:3,className:"text-right font-medium",children:"Delivery Fee"}),s.jsx(S.pj,{className:"text-right font-medium",children:(0,ej.xG)(t.deliveryFee||0)})]})]})]}),s.jsx("div",{className:"flex justify-end",children:s.jsx(w.z,{asChild:!0,children:(0,s.jsxs)(o.default,{href:r[0]?.bestPrice?.url||`https://www.${e.toLowerCase()}.com`,target:"_blank",rel:"noopener noreferrer",children:[s.jsx(h.Z,{className:"mr-2 h-4 w-4"}),"Shop on ",e,s.jsx(v.Z,{className:"ml-2 h-4 w-4"})]})})})]},e)}),s.jsx(A.Zb,{className:"bg-green-50 dark:bg-green-900/20 border-green-200",children:s.jsx(A.aY,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-green-700",children:"Total Savings"}),s.jsx("p",{className:"text-sm text-green-600",children:"Compared to best single platform"})]}),(0,s.jsxs)("div",{className:"text-right",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:(0,ej.xG)(B)}),(0,s.jsxs)(C.C,{variant:"success",children:[U,"% cheaper"]})]})]})})})]}):s.jsx("div",{className:"text-center py-6 text-muted-foreground",children:"No price data available for optimization"})})]})}),s.jsx(ev,{value:"comparison",className:"mt-4",children:(0,s.jsxs)(A.Zb,{children:[(0,s.jsxs)(A.Ol,{children:[(0,s.jsxs)(A.ll,{className:"flex items-center",children:[s.jsx(h.Z,{className:"mr-2 h-5 w-5 text-primary"}),"Platform Price Comparison"]}),s.jsx(A.SZ,{children:"Compare prices for each item across all platforms"})]}),s.jsx(A.aY,{children:s.jsx("div",{className:"overflow-x-auto",children:(0,s.jsxs)(S.iA,{children:[s.jsx(S.xD,{children:(0,s.jsxs)(S.SC,{children:[s.jsx(S.ss,{children:"Item"}),s.jsx(S.ss,{children:"Quantity"}),Array.isArray(i)&&i.map(e=>e?s.jsx(S.ss,{className:"min-w-[120px]",children:(0,s.jsxs)("div",{className:"flex items-center",children:[e.logoUrl?s.jsx("div",{className:"w-6 h-6 mr-1 relative overflow-hidden rounded",children:s.jsx(l(),{src:e.logoUrl,alt:e.name,fill:!0,className:"object-contain"})}):null,e.name]})},e.id):null)]})}),(0,s.jsxs)(S.RM,{children:[Array.isArray(r)&&r.map(e=>{if(!e)return null;let r=W(e);return(0,s.jsxs)(S.SC,{children:[s.jsx(S.pj,{className:"font-medium",children:(0,s.jsxs)("div",{className:"flex items-center",children:[e.name||"Unknown Item",4===r?s.jsx(C.C,{variant:"success",className:"ml-2 text-xs",children:"All platforms"}):r>=3?(0,s.jsxs)(C.C,{variant:"secondary",className:"ml-2 text-xs",children:[r," platforms"]}):null]})}),(0,s.jsxs)(S.pj,{children:["number"==typeof e.quantity?e.quantity:1,e.unit&&s.jsx("span",{className:"text-muted-foreground",children:e.unit})]}),Array.isArray(i)&&i.map(r=>{if(!r)return null;let t=e.prices&&Array.isArray(e.prices)?e.prices.find(e=>e&&e.platform===r.name):void 0;return s.jsx(S.pj,{children:t?s.jsx("div",{children:t.available?(0,s.jsxs)("div",{className:"flex flex-col",children:[s.jsx("span",{className:"font-medium",children:(0,ej.xG)(t.price)}),t.url&&(0,s.jsxs)(o.default,{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:underline flex items-center mt-1",children:["View ",s.jsx(v.Z,{className:"ml-1 h-3 w-3"})]})]}):s.jsx(C.C,{variant:"outline",className:"text-muted-foreground",children:"Not available"})}):s.jsx("span",{className:"text-muted-foreground",children:"-"})},r.id)})]},e.id)}),(0,s.jsxs)(S.SC,{className:"bg-muted/50",children:[s.jsx(S.pj,{colSpan:2,className:"font-bold",children:"Platform Totals"}),Array.isArray(i)&&i.map(e=>e?s.jsx(S.pj,{className:"font-bold",children:O[e.name]>0?(0,ej.xG)(O[e.name]):s.jsx("span",{className:"text-muted-foreground",children:"-"})},e.id):null)]}),(0,s.jsxs)(S.SC,{children:[s.jsx(S.pj,{colSpan:2,className:"font-medium text-muted-foreground",children:"Items Available"}),Array.isArray(i)&&i.map(e=>{if(!e)return null;let t=Array.isArray(r)?r.filter(r=>r&&r.prices&&Array.isArray(r.prices)&&r.prices.some(r=>r&&r.platform===e.name&&r.available)).length:0,a=Array.isArray(r)?r.length:0;return s.jsx(S.pj,{children:t>0?(0,s.jsxs)(C.C,{variant:t===a?"success":"warning",children:[t,"/",a]}):(0,s.jsxs)(C.C,{variant:"outline",className:"text-muted-foreground",children:["0/",a]})},e.id)})]}),(0,s.jsxs)(S.SC,{children:[s.jsx(S.pj,{colSpan:2,className:"font-medium text-muted-foreground",children:"Delivery Fee"}),Array.isArray(i)&&i.map(e=>e?s.jsx(S.pj,{children:(0,ej.xG)(e.deliveryFee||0)},e.id):null)]}),(0,s.jsxs)(S.SC,{children:[s.jsx(S.pj,{colSpan:2,className:"font-medium text-muted-foreground",children:"Min Order Value"}),Array.isArray(i)&&i.map(e=>e?s.jsx(S.pj,{children:(e.minOrderValue||0)>0?(0,ej.xG)(e.minOrderValue||0):s.jsx("span",{className:"text-muted-foreground",children:"None"})},e.id):null)]})]})]})})}),(0,s.jsxs)(A.eW,{className:"flex justify-between",children:[s.jsx("div",{className:"text-sm text-muted-foreground",children:"* Prices include delivery fees where applicable"}),(0,s.jsxs)("div",{className:"flex items-center",children:[s.jsx("span",{className:"mr-2 text-sm font-medium",children:"Best Value:"}),(0,s.jsxs)(C.C,{variant:"success",className:"flex items-center",children:["Optimized Shopping",s.jsx(p,{className:"ml-1 h-3 w-3"})]})]})]})]})})]})})]}):s.jsx(A.Zb,{className:"bg-muted/50",children:(0,s.jsxs)(A.aY,{className:"pt-6 text-center",children:[s.jsx("p",{className:"mb-4",children:"No items in this shopping list yet."}),s.jsx(w.z,{asChild:!0,children:(0,s.jsxs)(o.default,{href:`/dashboard/lists/${e}`,children:[s.jsx(h.Z,{className:"mr-2 h-4 w-4"}),"Go Back to Shopping List"]})})]})})}ev.displayName=ep.displayName},4857:(e,r,t)=>{"use strict";t.d(r,{C:()=>l});var s=t(4848);t(5642);var a=t(5811),i=t(5709);let n=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-green-500 text-white hover:bg-green-600",warning:"border-transparent bg-yellow-500 text-white hover:bg-yellow-600",info:"border-transparent bg-blue-500 text-white hover:bg-blue-600"}},defaultVariants:{variant:"default"}});function l({className:e,variant:r,...t}){return s.jsx("div",{className:(0,i.cn)(n({variant:r}),e),...t})}},391:(e,r,t)=>{"use strict";t.d(r,{Ol:()=>l,SZ:()=>d,Zb:()=>n,aY:()=>c,eW:()=>m,ll:()=>o});var s=t(4848),a=t(5642),i=t(5709);let n=a.forwardRef(({className:e,...r},t)=>s.jsx("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm transition-all hover:shadow-md",e),...r}));n.displayName="Card";let l=a.forwardRef(({className:e,...r},t)=>s.jsx("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",e),...r}));l.displayName="CardHeader";let o=a.forwardRef(({className:e,...r},t)=>s.jsx("h3",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",e),...r}));o.displayName="CardTitle";let d=a.forwardRef(({className:e,...r},t)=>s.jsx("p",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",e),...r}));d.displayName="CardDescription";let c=a.forwardRef(({className:e,...r},t)=>s.jsx("div",{ref:t,className:(0,i.cn)("p-6 pt-0",e),...r}));c.displayName="CardContent";let m=a.forwardRef(({className:e,...r},t)=>s.jsx("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",e),...r}));m.displayName="CardFooter"},151:(e,r,t)=>{"use strict";t.d(r,{RM:()=>o,SC:()=>d,iA:()=>n,pj:()=>m,ss:()=>c,xD:()=>l});var s=t(4848),a=t(5642),i=t(5709);let n=a.forwardRef(({className:e,...r},t)=>s.jsx("div",{className:"relative w-full overflow-auto",children:s.jsx("table",{ref:t,className:(0,i.cn)("w-full caption-bottom text-sm",e),...r})}));n.displayName="Table";let l=a.forwardRef(({className:e,...r},t)=>s.jsx("thead",{ref:t,className:(0,i.cn)("[&_tr]:border-b",e),...r}));l.displayName="TableHeader";let o=a.forwardRef(({className:e,...r},t)=>s.jsx("tbody",{ref:t,className:(0,i.cn)("[&_tr:last-child]:border-0",e),...r}));o.displayName="TableBody",a.forwardRef(({className:e,...r},t)=>s.jsx("tfoot",{ref:t,className:(0,i.cn)("bg-primary font-medium text-primary-foreground",e),...r})).displayName="TableFooter";let d=a.forwardRef(({className:e,...r},t)=>s.jsx("tr",{ref:t,className:(0,i.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...r}));d.displayName="TableRow";let c=a.forwardRef(({className:e,...r},t)=>s.jsx("th",{ref:t,className:(0,i.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...r}));c.displayName="TableHead";let m=a.forwardRef(({className:e,...r},t)=>s.jsx("td",{ref:t,className:(0,i.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...r}));m.displayName="TableCell",a.forwardRef(({className:e,...r},t)=>s.jsx("caption",{ref:t,className:(0,i.cn)("mt-4 text-sm text-muted-foreground",e),...r})).displayName="TableCaption"},6953:(e,r,t)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,r){for(var t in r)Object.defineProperty(e,t,{enumerable:!0,get:r[t]})}(r,{default:function(){return o},getImageProps:function(){return l}});let s=t(9024),a=t(8334),i=t(4582),n=s._(t(3975));function l(e){let{props:r}=(0,a.getImgProps)(e,{defaultLoader:n.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!0}});for(let[e,t]of Object.entries(r))void 0===t&&delete r[e];return{props:r}}let o=i.Image},5662:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>u,dynamic:()=>m});var s=t(2820),a=t(8171),i=t(2410),n=t(8087),l=t(792),o=t(6525);let d=(0,t(7138).createProxy)(String.raw`/home/ubuntu/grocery_price_comparison/app/components/price-comparison.tsx#PriceComparison`);var c=t(9382);let m="force-dynamic";async function u({params:e}){let{id:r}=e;try{let e=await c._.shoppingList.findUnique({where:{id:r}});return e||(0,i.notFound)(),(0,s.jsxs)("div",{className:"container mx-auto max-w-7xl px-4 py-8",children:[(0,s.jsxs)("div",{className:"mb-8",children:[s.jsx("div",{className:"flex items-center gap-2 mb-2",children:s.jsx(o.z,{variant:"ghost",size:"sm",asChild:!0,children:(0,s.jsxs)(a.default,{href:`/dashboard/lists/${r}`,children:[s.jsx(n.Z,{className:"h-4 w-4 mr-1"}),"Back to List"]})})}),(0,s.jsxs)("h1",{className:"text-3xl font-bold flex items-center",children:[s.jsx(l.Z,{className:"mr-2 h-6 w-6 text-primary"}),"Price Comparison: ",e.name]}),s.jsx("p",{className:"text-muted-foreground",children:"Compare prices across platforms and optimize your shopping"})]}),s.jsx(d,{listId:r})]})}catch(e){return console.error("Error in ComparePage:",e),s.jsx("div",{className:"container mx-auto max-w-7xl px-4 py-8",children:(0,s.jsxs)("div",{className:"mb-8",children:[s.jsx("div",{className:"flex items-center gap-2 mb-2",children:s.jsx(o.z,{variant:"ghost",size:"sm",asChild:!0,children:(0,s.jsxs)(a.default,{href:"/dashboard",children:[s.jsx(n.Z,{className:"h-4 w-4 mr-1"}),"Back to Dashboard"]})})}),s.jsx("h1",{className:"text-3xl font-bold",children:"Error Loading Comparison"}),s.jsx("p",{className:"text-muted-foreground",children:"We encountered an error while loading the price comparison. Please try again later."})]})})}}},6525:(e,r,t)=>{"use strict";t.d(r,{z:()=>d});var s=t(2820),a=t(2607),i=t(212),n=t(4470),l=t(9623);let o=(0,n.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",success:"bg-green-600 text-white hover:bg-green-700"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef(({className:e,variant:r,size:t,asChild:a=!1,...n},d)=>{let c=a?i.g7:"button";return s.jsx(c,{className:(0,l.cn)(o({variant:r,size:t,className:e})),ref:d,...n})});d.displayName="Button"},9382:(e,r,t)=>{"use strict";t.d(r,{_:()=>a});let s=require("@prisma/client"),a=global.prisma||new s.PrismaClient({log:["query"]})},9623:(e,r,t)=>{"use strict";t.d(r,{cn:()=>i});var s=t(1002),a=t(7290);function i(...e){return(0,a.m6)((0,s.W)(e))}}};var r=require("../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[923,724,709,571,582,296],()=>t(2565));module.exports=s})();